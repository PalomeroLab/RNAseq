#!/bin/sh

# Get the directory of the current script
this_dir=$(dirname "$(readlink -f "$0")")

# Change to the directory where the script is located
cd "$this_dir" || {
	printf "Failed to change directory to %s\n" "$this_dir" >&2
	exit 1
}

# Get the instance ID or other information using the ec2-list-instances script
# Use fzf to select one, then process the selection to get the second column (or first if only one column)
selected_instance=$(../aws/ec2-list-instances.sh | fzf | awk '{if (NF > 1) print $2; else print $1}')

# Check if a valid selection was made
if [ "$selected_instance" = "" ]; then
	printf "No instance selected. Exiting.\n" >&2
	exit 1
fi

printf "Starting instance %s\n" "$selected_instance"
# Use AWS CLI to start the selected instance
aws ec2 start-instances --instance-ids "$selected_instance"

